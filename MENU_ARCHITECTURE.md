# MENU_ARCHITECTURE.md

**Status:** PROPOSAL (v1.1)
**Based on:** [FUNCTIONAL_REGISTRY.md](./FUNCTIONAL_REGISTRY.md)
**Goal:** Unified, scalable navigation structure for MatrixGin v2.0

---

## 1. Концепция: "Сферы ответственности"

Мы используем концепцию **"Сфер ответственности"** (Clusters).

**Для обычного сотрудника:** Видны только A (Личное) и B (Университет).
**Для руководителя:** Добавляется C (Управление).
**Для HR:** Добавляется E (Кадры).
**Для СУПЕРЮЗЕРА (Разработчика/Архитектора):** Видны **ВСЕ КЛАСТЕРЫ (A-F)** + Спец-инструменты.

**Основные кластеры:**
A. **MY SPACE (Личное)** — Зона личной эффективности.
B. **UNIVERSITY (Развитие)** — Зона роста.
C. **MANAGEMENT (Управление)** — Зона ответственности.
D. **OPERATIONS (Производство/ERP)** — Бизнес-процессы.
E. **PERSONNEL (Кадры)** — Человеческий капитал.
F. **SYSTEM (Администрирование)** — Настройка системы.

---

## 2. Структура Суперюзера (FULL VIEW)

Суперюзер видит полную картину. Эта структура **идеальна** для него, так как позволяет переключаться между контекстами ("Я сейчас сотрудник", "Я сейчас админ"), не теряясь в списке из 50 пунктов.

### A. MY SPACE
*Контекст: "Я как пользователь системы"*
1.  Dashboard
2.  Задачи
3.  Экономика (Кошелек, Магазин, Аукционы)
4.  Достижения (КвалификацияРейтинг, Статусы, Ранги, Ачивки)
5.  Профиль

### B. UNIVERSITY
*Контекст: "Я обучаюсь или управляю контентом"*
1.  Каталог курсов
2.  Мое обучение
3.  Тренерская панель
4.  **Content Factory** (Конструктор курсов)

### C. MANAGEMENT
*Контекст: "Я руковожу людьми"*
1.  Кабинет руководителя
2.  Моя команда
3.  Оценка 360 / Feedback

### D. OPERATIONS
*Контекст: "Я управляю ресурсами"*
1.  Производство (Сессии)
2.  Склад (WMS)
3.  Закупки & Финансы

### E. PERSONNEL
*Контекст: "Я HR-директор"*
1.  HR Dashboard
2.  Глобальный список сотрудников
3.  Кадровое дело (Личные дела, Приказы)
4.  Оргструктура (OFS Editor)
    - Организационная структура
    - Исполнительная ОФС
    - ЦКП (структура и связи Ценных Конечных Продуктов отделов, функций, должностей)
    - Матрица ролей
    - Матрица ответственности
    - Структурные срезы

### F. SYSTEM (SUPERUSER ZONE)
*Контекст: "Я Бог системы"*

1.  **Global Dashboard** (Executive Analytics)
2.  **Реестр (Registry)** — *Главный инструмент "Бога"*
    *   Сущности
    *   Связи
3.  **Конфигурация**
    *   Статусы (Status Management)
    *   Библиотека (Archive Admin)
4.  **Безопасность**
    *   Anti-Fraud
    *   AI Feedback Analytics
5.  **DEV TOOLS** (Только для Superuser)
    *   **Feature Flags**
    *   **System Health** (Redis/BullMQ)
    *   **Logs / Audit**
    *   **Impersonation** (Войти под другим юзером)

---

## 3. Почему это удобно для Разработчика?

1.  **Изоляция контекста:** Когда ты дебажишь "Личный кабинет", тебе не мешают кнопки "Админки". Ты работаешь в кластере **A**.
2.  **Быстрый доступ к "Кишкам":** Кластер **F** (System) всегда под рукой для настройки конфигураций.
3.  **Реестр (Registry):** Вынесен в Cluster F как основной низкоуровневый инструмент.
4.  **Визуальная валидация:** Ты сразу видишь, какие разделы видит конкретная роль, просто переключаясь между кластерами.

### Техническая пометка: Ролевой Эмулятор (Dev Mode)
Для удобства разработки и демонстрации внедряется плавающий виджет **"Role Switcher"**.

**Режимы эмуляции:**
1.  **Employee:** Обычный сотрудник (Cluster A, B).
2.  **Tactical Manager:** Руководитель отдела (Cluster A, B, C).
3.  **Strategic Manager:** ТОП-менеджмент (Cluster A, B, C + Analytics).
4.  **Superuser (God Mode):** Полный доступ (Cluster A-F + Dev Tools).

*Эмулятор подменяет права `currentRole` в frontend-контексте, не затрагивая реальный токен.*

---

## 4. Пример конфигурации (JSON)

```json
[
  {
    "id": "system",
    "title": "СИСТЕМА",
    "roles": ["ADMIN", "SUPERUSER"],
    "items": [
      { "label": "Global Dash", "path": "/analytics/executive" },
      { "label": "Registry", "path": "/registry" },
      {
        "label": "Dev Tools",
        "roles": ["SUPERUSER"],
        "path": "/admin/dev-tools",
        "children": [
            { "label": "Impersonate", "path": "/admin/impersonate" },
            { "label": "Feature Flags", "path": "/admin/flags" }
        ]
      }
    ]
  }
]
```
