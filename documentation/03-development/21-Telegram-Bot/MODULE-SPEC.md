# –ú–æ–¥—É–ª—å: Telegram Bot

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ö–†–ò–¢–ò–ß–ù–´–ô (MVP Phase 1)  
**–°—Ä–æ–∫:** –ù–µ–¥–µ–ª–∏ 5-6  
**–ö–æ–º–∞–Ω–¥–∞:** 1 Backend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫

---

## üìã –û–ü–ò–°–ê–ù–ò–ï

Telegram –±–æ—Ç - –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram Mini Apps (TMA) –¥–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ Telegram.

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

‚úÖ **–ë–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
- `/start` - –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ + —Å—Å—ã–ª–∫–∞ –Ω–∞ TMA
- `/help` - —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥
- `/tasks` - –º–æ–∏ –∑–∞–¥–∞—á–∏
- `/status` - —Å—Ç–∞—Ç—É—Å, –±–∞–ª–∞–Ω—Å MC/GMC
- `/create` - —Å–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É
- `/logout` - –≤—ã—Ö–æ–¥

‚úÖ **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
- –ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∞
- –ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–¥–∞—á–µ
- MC –Ω–∞—á–∏—Å–ª–µ–Ω—ã
- MC —Å–∫–æ—Ä–æ —Å–≥–æ—Ä—è—Ç
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞/—Ä–∞–Ω–≥–∞

‚úÖ **Telegram Mini Apps (TMA):**
- –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π React UI –≤–Ω—É—Ç—Ä–∏ Telegram
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram ID
- –î–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

‚úÖ **Inline –∫–Ω–æ–ø–∫–∏:**
- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (Complete Task, View Details)
- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –∑–∞–¥–∞—á–∞–º
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

---

## ü§ñ –ö–û–ú–ê–ù–î–´ –ë–û–¢–ê

### /start
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è

**–û—Ç–≤–µ—Ç:**
```
–ü—Ä–∏–≤–µ—Ç, {FirstName}! üëã

–Ø MatrixGin - —Ç–≤–æ–π —Ü–∏—Ñ—Ä–æ–≤–æ–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –≤ –§–æ—Ç–æ–º–∞—Ç—Ä–∏—Ü–µ.

–ß—Ç–æ —è —É–º–µ—é:
‚úÖ –£–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–¥–∞—á–∞–º–∏
‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–≤–æ–π —Å—Ç–∞—Ç—É—Å –∏ –±–∞–ª–∞–Ω—Å
‚úÖ –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
‚úÖ –°–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–¥–∞—á–∏ –≥–æ–ª–æ—Å–æ–º

–û—Ç–∫—Ä—ã—Ç—å –ø–æ–ª–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
[üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å MatrixGin] (TMA –∫–Ω–æ–ø–∫–∞)

–ö–æ–º–∞–Ω–¥—ã: /help
```

**Backend:**
```typescript
async handleStart(ctx) {
  const telegramId = ctx.from.id;
  const username = ctx.from.username;
  const firstName = ctx.from.first_name;
  
  // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
  let user = await prisma.user.findUnique({
    where: { telegram_id: telegramId }
  });
  
  if (!user) {
    // –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    user = await prisma.user.create({
      data: {
        telegram_id: telegramId,
        telegram_username: username,
        first_name: firstName,
        role_id: defaultRoleId
      }
    });
  }
  
  await ctx.reply(welcomeMessage, {
    reply_markup: {
      inline_keyboard: [[
        { text: 'üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å MatrixGin', web_app: { url: TMA_URL } }
      ]]
    }
  });
}
```

---

### /help
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥

**–û—Ç–≤–µ—Ç:**
```
üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:

/tasks - –ú–æ–∏ –∑–∞–¥–∞—á–∏
/status - –ú–æ–π —Å—Ç–∞—Ç—É—Å –∏ –±–∞–ª–∞–Ω—Å
/create - –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É
/wallet - –ö–æ—à–µ–ª–µ–∫ MC/GMC
/logout - –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã

üåê –ü–æ–ª–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
[–û—Ç–∫—Ä—ã—Ç—å MatrixGin] (TMA –∫–Ω–æ–ø–∫–∞)

üí¨ –ü–æ–¥–¥–µ—Ä–∂–∫–∞: @support
```

---

### /tasks
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–û—Ç–≤–µ—Ç:**
```
üìù –¢–≤–æ–∏ –∑–∞–¥–∞—á–∏ (5 –∞–∫—Ç–∏–≤–Ω—ã—Ö):

1Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∏–Ω—Ç–µ—Ä—ã –Ω–∞ –ú–∏—Ä–∞
   üìç –§–∏–ª–∏–∞–ª –ú–∏—Ä–∞
   ‚è∞ –î–æ: —Å–µ–≥–æ–¥–Ω—è 18:00
   [‚úÖ –í—ã–ø–æ–ª–Ω–∏—Ç—å] [üëÅ –î–µ—Ç–∞–ª–∏]

2Ô∏è‚É£ –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–π—Å-–ª–∏—Å—Ç
   üìç –û—Ñ–∏—Å
   ‚è∞ –î–æ: –∑–∞–≤—Ç—Ä–∞ 12:00
   [‚úÖ –í—ã–ø–æ–ª–Ω–∏—Ç—å] [üëÅ –î–µ—Ç–∞–ª–∏]

...

[‚ûï –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É] /create
```

**Backend:**
```typescript
async handleTasks(ctx) {
  const telegramId = ctx.from.id;
  const user = await getUserByTelegramId(telegramId);
  
  if (!user) {
    return ctx.reply('–°–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏ /start');
  }
  
  const tasks = await prisma.task.findMany({
    where: {
      assignee_id: user.id,
      status: { in: ['pending', 'in_progress'] }
    },
    take: 10,
    orderBy: { deadline: 'asc' }
  });
  
  const message = formatTaskList(tasks);
  const buttons = tasks.map(task => [
    { text: `‚úÖ ${task.title}`, callback_data: `complete_${task.id}` },
    { text: 'üëÅ', callback_data: `view_${task.id}` }
  ]);
  
  await ctx.reply(message, {
    reply_markup: { inline_keyboard: buttons }
  });
}
```

---

### /status
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°—Ç–∞—Ç—É—Å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –∏ –±–∞–ª–∞–Ω—Å

**–û—Ç–≤–µ—Ç:**
```
üë§ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤
‚≠ê –°—Ç–∞—Ç—É—Å: –¢–æ–ø—á–∏–∫
üèÜ –†–∞–Ω–≥: –ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä

üí∞ –ë–∞–ª–∞–Ω—Å:
‚Ä¢ MC: 1,250 (‚ö†Ô∏è 150 —Å–≥–æ—Ä—è—Ç —á–µ—Ä–µ–∑ 7 –¥–Ω–µ–π)
‚Ä¢ GMC: 50

üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
‚Ä¢ –ó–∞–¥–∞—á –≤—ã–ø–æ–ª–Ω–µ–Ω–æ: 45
‚Ä¢ KPI: 95.5%
‚Ä¢ –°—Ç–∞–∂: 10 –º–µ—Å—è—Ü–µ–≤

üìà –î–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ (–ö—Ä–µ–º–µ–Ω—å):
‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñë‚ñë 60%
‚Ä¢ –û—Å—Ç–∞–ª–æ—Å—å –∑–∞–¥–∞—á: 5
‚Ä¢ –û—Å—Ç–∞–ª–æ—Å—å MC: 250

[üíº –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ—Ñ–∏–ª—å] (TMA –∫–Ω–æ–ø–∫–∞)
```

---

### /create
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É —á–µ—Ä–µ–∑ inline —Ñ–æ—Ä–º –∏–ª–∏ –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

**–û—Ç–≤–µ—Ç:**
```
üìù –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏

–°–ø–æ—Å–æ–± 1: –¢–µ–∫—Å—Ç–æ–º
–û–ø–∏—à–∏ –∑–∞–¥–∞—á—É –æ–¥–Ω–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º, –Ω–∞–ø—Ä–∏–º–µ—Ä:
"–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∏–Ω—Ç–µ—Ä—ã –Ω–∞ –ú–∏—Ä–∞ –∑–∞–≤—Ç—Ä–∞ –¥–æ 18:00"

–°–ø–æ—Å–æ–± 2: –ì–æ–ª–æ—Å–æ–º üé§
–ó–∞–ø–∏—à–∏ –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∑–∞–¥–∞—á–∏

–°–ø–æ—Å–æ–± 3: –§–æ—Ä–º–∞
[üìã –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É] (inline –∫–Ω–æ–ø–∫–∞)

–û—Ç–º–µ–Ω–∞: /cancel
```

**Backend (NLP –ø–∞—Ä—Å–∏–Ω–≥):**
```typescript
async handleCreateTask(ctx) {
  const text = ctx.message.text;
  
  // NLP –ø–∞—Ä—Å–∏–Ω–≥
  const parsed = await nlpService.parseTask(text);
  
  // –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É
  const task = await taskService.create({
    title: parsed.action + ' ' + parsed.object,
    description: text,
    location: parsed.location,
    deadline: parsed.deadline,
    priority: parsed.priority,
    creator_id: user.id
  });
  
  // –ê–≤—Ç–æ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ –ú–î–†
  const assignee = await taskAssignmentService.autoAssign(task);
  
  await ctx.reply(`
‚úÖ –ó–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞!

üìù ${task.title}
üë§ –ù–∞–∑–Ω–∞—á–µ–Ω–∞: ${assignee.name}
üìç ${task.location}
‚è∞ –î–æ: ${formatDate(task.deadline)}

[üëÅ –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å] /tasks
  `);
}
```

---

### /wallet
**–û–ø–∏—Å–∞–Ω–∏–µ:** –î–µ—Ç–∞–ª–∏ –∫–æ—à–µ–ª—å–∫–∞

**–û—Ç–≤–µ—Ç:**
```
üí∞ –¢–≤–æ–π –∫–æ—à–µ–ª–µ–∫

MC (MatrixCoin):
‚Ä¢ –î–æ—Å—Ç—É–ø–Ω–æ: 1,100
‚Ä¢ –í —Å–µ–π—Ñ–µ: 100 (–¥–æ 22.12.2025)
‚Ä¢ –°–≥–æ—Ä–∞–µ—Ç: 150 (—á–µ—Ä–µ–∑ 7 –¥–Ω–µ–π)

GMC (Golden MC):
‚Ä¢ –ë–∞–ª–∞–Ω—Å: 50

üìä –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π:
[üìú –û—Ç–∫—Ä—ã—Ç—å] (TMA –∫–Ω–æ–ø–∫–∞)

üõí –ú–∞–≥–∞–∑–∏–Ω:
[üõç –ö—É–ø–∏—Ç—å —Ç–æ–≤–∞—Ä—ã] (TMA –∫–Ω–æ–ø–∫–∞)
```

---

## üì¨ –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø

### –¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

#### 1. –ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞
```
üÜï –ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞!

üìù –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∏–Ω—Ç–µ—Ä—ã –Ω–∞ –ú–∏—Ä–∞
üìç –§–∏–ª–∏–∞–ª –ú–∏—Ä–∞
‚è∞ –î–æ: —Å–µ–≥–æ–¥–Ω—è 18:00
üí∞ –ù–∞–≥—Ä–∞–¥–∞: +100 MC

[‚úÖ –ü—Ä–∏–Ω—è—Ç—å] [üëÅ –î–µ—Ç–∞–ª–∏]
```

#### 2. –ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
```
‚úÖ –ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞!

üìù –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–π—Å-–ª–∏—Å—Ç
üí∞ +80 MC –Ω–∞—á–∏—Å–ª–µ–Ω–æ
üéØ KPI –æ–±–Ω–æ–≤–ª–µ–Ω: 95.5% (+2%)

[üìä –ú–æ–π —Å—Ç–∞—Ç—É—Å] /status
```

#### 3. MC —Å–≥–æ—Ä–∞—é—Ç
```
‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ!

üí∏ 150 MC —Å–≥–æ—Ä—è—Ç —á–µ—Ä–µ–∑ 3 –¥–Ω—è!

–ò—Å–ø–æ–ª—å–∑—É–π –∏—Ö –∏–ª–∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π –°–µ–π—Ñ:
[üîí –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –°–µ–π—Ñ] (callback)
[üõç –ö—É–ø–∏—Ç—å –≤ –º–∞–≥–∞–∑–∏–Ω–µ] (TMA)
```

#### 4. –ü–æ–≤—ã—à–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
```
üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!

‚≠ê –ù–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å: –ö—Ä–µ–º–µ–Ω—å!

üéÅ –ë–æ–Ω—É—Å—ã:
‚Ä¢ +500 MC
‚Ä¢ –°–∫–∏–¥–∫–∞ 10% –≤ –º–∞–≥–∞–∑–∏–Ω–µ
‚Ä¢ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –≤ –∑–∞–¥–∞—á–∞—Ö

[üèÜ –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å] /status
```

---

## üåê TELEGRAM MINI APPS (TMA)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞

```javascript
// frontend/src/telegram/tma.ts
import { useEffect } from 'react';

export function useTelegramWebApp() {
  useEffect(() => {
    const tg = window.Telegram.WebApp;
    
    // –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    tg.expand();
    
    // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ü–≤–µ—Ç–∞ —Ç–µ–º—ã
    tg.setHeaderColor('#1976d2');
    tg.setBackgroundColor('#ffffff');
    
    // –í–∫–ª—é—á–∏—Ç—å –≥–ª–∞–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
    tg.MainButton.setText('–°–æ—Ö—Ä–∞–Ω–∏—Ç—å');
    tg.MainButton.show();
    tg.MainButton.onClick(() => {
      // –î–µ–π—Å—Ç–≤–∏–µ –ø—Ä–∏ –∫–ª–∏–∫–µ
    });
    
    // –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const user = tg.initDataUnsafe.user;
    
    return () => {
      tg.MainButton.hide();
    };
  }, []);
}
```

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ TMA

```typescript
// Backend: Verify Telegram data
import crypto from 'crypto';

function verifyTelegramWebAppData(initData: string): boolean {
  const secret = crypto
    .createHmac('sha256', 'WebAppData')
    .update(TELEGRAM_BOT_TOKEN)
    .digest();
    
  const dataCheckString = /* parse initData */;
  
  const hash = crypto
    .createHmac('sha256', secret)
    .update(dataCheckString)
    .digest('hex');
    
  return hash === receivedHash;
}

// Endpoint –¥–ª—è TMA auth
@Post('/api/auth/telegram')
async telegramAuth(@Body() data: TelegramAuthDto) {
  if (!verifyTelegramWebAppData(data.initData)) {
    throw new UnauthorizedException();
  }
  
  const user = await getUserByTelegramId(data.user.id);
  const tokens = await authService.generateTokens(user);
  
  return tokens;
}
```

---

## üîå WEBHOOK VS POLLING

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: Webhook (production)

```typescript
// src/telegram/telegram.module.ts
import { Telegraf } from 'telegraf';

const bot = new Telegraf(TELEGRAM_BOT_TOKEN);

// Webhook setup
app.use(bot.webhookCallback('/telegram-webhook'));

bot.telegram.setWebhook(`${APP_URL}/telegram-webhook`);
```

### Polling (development)

```typescript
// –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
bot.launch();
```

---

## üóÑÔ∏è –ë–ê–ó–ê –î–ê–ù–ù–´–•

### –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ users table

```sql
ALTER TABLE users ADD COLUMN IF NOT EXISTS telegram_chat_id BIGINT;
ALTER TABLE users ADD COLUMN IF NOT EXISTS telegram_notifications_enabled BOOLEAN DEFAULT true;

CREATE INDEX idx_users_telegram_chat ON users(telegram_chat_id);
```

### –¢–∞–±–ª–∏—Ü–∞ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π

```sql
CREATE TABLE telegram_messages (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id),
    chat_id BIGINT NOT NULL,
    message_id INTEGER NOT NULL,
    message_type VARCHAR(50), -- notification, command_response
    content JSONB,
    created_at TIMESTAMPTZ DEFAULT NOW()
);
```

---

## üìä –ú–ï–¢–†–ò–ö–ò –£–°–ü–ï–•–ê

- [ ] 80%+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏—Å–ø–æ–ª—å–∑—É—é—Ç Telegram –±–æ—Ç
- [ ] 50%+ –∑–∞–¥–∞—á —Å–æ–∑–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ Telegram
- [ ] <2 —Å–µ–∫—É–Ω–¥—ã —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞
- [ ] 99%+ uptime
- [ ] NLP —Ç–æ—á–Ω–æ—Å—Ç—å >85%
- [ ] TMA –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è <3 —Å–µ–∫—É–Ω–¥

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### Unit Tests
- ‚úÖ –ö–æ–º–∞–Ω–¥—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ NLP –ø–∞—Ä—Å–∏–Ω–≥
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ Callback handlers

### Integration Tests
- ‚úÖ E2E: /start ‚Üí /tasks ‚Üí complete task
- ‚úÖ E2E: /create ‚Üí NLP ‚Üí task created
- ‚úÖ Webhook delivery
- ‚úÖ TMA authentication

---

## üìù –ó–ê–í–ò–°–ò–ú–û–°–¢–ò

### –û—Ç –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª–µ–π
- `02-Authentication-Authorization` - user accounts
- `20-Task-Management` - –∑–∞–¥–∞—á–∏
- `15-MatrixCoin-Economy` - –±–∞–ª–∞–Ω—Å
- `01-Advanced-Gamification` - —Å—Ç–∞—Ç—É—Å—ã

### –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–æ–¥—É–ª—è–º–∏
- –í—Å–µ –º–æ–¥—É–ª–∏ - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
