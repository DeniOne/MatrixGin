# 02-mc-lifecycle.md
## MC Lifecycle — Domain Rulebook

---

## 0. Назначение документа

Документ описывает **жизненный цикл Matrix Coin (MC)**:
- как MC появляются;
- как используются;
- как считаются израсходованными;
- какие действия запрещены.

Документ:
- предназначен для эксплуатации и поддержки;
- описывает реальную механику системы;
- **не является CANON** и может дополняться.

---

## 1. Что такое MC в операционном смысле

MC — это **операционная единица участия**, фиксирующая действия пользователя в системе.

MC:
- не деньги;
- не баланс в экономическом смысле;
- не вознаграждение;
- не KPI.

В операционном контуре MC — это:
- события;
- агрегируемые состояния;
- ограничения доступа к действиям.

---

## 2. Состояния MC

MC существует в трёх состояниях:

1. **Available** — доступные для использования  
2. **Reserved** — временно зарезервированные  
3. **Consumed** — использованные (исторический факт)

Состояния:
- не редактируются вручную;
- выводятся из событий.

---

## 3. Начисление MC (Accrual)

### 3.1. Основания начисления

MC начисляются:
- за зафиксированное действие;
- при выполнении условий, описанных в правилах;
- через явное событие начисления.

MC **не начисляются**:
- автоматически «по расписанию»;
- за ожидание;
- за наличие статуса.

---

### 3.2. Процесс начисления

1. Происходит действие пользователя
2. Система валидирует действие
3. Фиксируется событие `MCAccrued`
4. MC становятся **Available**

Начисление:
- всегда имеет источник;
- всегда имеет audit-контекст;
- не может быть анонимным.

---

## 4. Использование MC (Usage)

### 4.1. Основания использования

MC используются:
- для участия в аукционах;
- для доступа к определённым действиям;
- в рамках явно разрешённых сценариев.

Любое использование MC:
- должно быть инициировано человеком;
- должно быть подтверждено событием.

---

### 4.2. Резервирование MC

Перед использованием:
- MC могут быть переведены в состояние **Reserved**;
- резервирование временное;
- резервирование фиксируется в audit.

Если действие не завершено:
- резерв снимается;
- MC возвращаются в Available.

---

## 5. Списание MC (Consumption)

### 5.1. Когда MC считаются использованными

MC считаются **Consumed**, если:
- действие завершено успешно;
- аукцион закрыт с победителем;
- условие использования выполнено полностью.

Consumed MC:
- не возвращаются;
- не перерассчитываются;
- остаются в истории навсегда.

---

### 5.2. Процесс списания

1. Завершается действие
2. Фиксируется событие `MCConsumed`
3. MC переходят в состояние **Consumed**

---

## 6. Отмена и ошибки

### 6.1. Отмена действия

Если действие отменено:
- MC не переходят в Consumed;
- Reserved MC возвращаются в Available;
- фиксируется событие отмены.

---

### 6.2. Ошибки системы

При технической ошибке:
- состояние MC не меняется;
- событие ошибки фиксируется;
- решение принимается вручную.

---

## 7. Ограничения и лимиты

MC подчиняются:
- лимитам начисления;
- лимитам использования;
- ограничениям по времени (если заданы).

Лимиты:
- задаются правилами;
- не могут обходиться вручную.

---

## 8. Запреты

Запрещено:
- начислять MC задним числом;
- списывать MC без события;
- редактировать баланс напрямую;
- переносить MC между пользователями без правила.

---

## 9. Связь MC с другими сущностями

- MC могут использоваться в аукционах GMC;
- MC не конвертируются в GMC напрямую;
- MC не имеют денежного эквивалента.

---

## 10. Примеры сценариев

### Стандартный сценарий
1. Пользователь совершает действие
2. MC начисляются
3. Пользователь участвует в аукционе
4. MC списываются при победе

### Ошибочный сценарий
1. Пользователь инициирует действие
2. Возникает ошибка
3. MC остаются Available
4. Событие ошибки зафиксировано

---

## 11. Краткое резюме

- MC — это события, а не деньги.
- Начисление → Использование → Списание.
- История неизменяема.
- Всё проходит через audit.
