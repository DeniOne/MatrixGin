# 01-auction-mechanics.md
## GMC Auction — Domain Rulebook

---

## 0. Назначение документа

Этот документ описывает **как реально работает аукцион GMC** в системе MatrixCoin Economy.

Документ:
- предназначен для запуска, поддержки и развития системы;
- фиксирует пошаговую механику;
- описывает edge-cases и ошибки.

Документ:
- **не является CANON**;
- **может дополняться и уточняться**;
- **не меняет смысл MC / GMC**, зафиксированный в `00-CANON`.

---

## 1. Термины и сущности

### Аукцион
Ограниченное во времени событие, в рамках которого участники **используют MC** для участия в распределении **GMC**.

### Лот
Объект аукциона. Лот определяет:
- что именно разыгрывается;
- на каких условиях;
- в каком объёме.

### Участник
Пользователь системы, допущенный к участию в конкретном аукционе.

### Ставка
Действие участника, выраженное в использовании MC, зафиксированное как событие.

### Победитель
Участник, чья ставка признана наивысшей на момент закрытия аукциона.

### Аукционное событие
Событие, зафиксированное в audit (open / participate / close).

---

## 2. Предусловия запуска аукциона

Аукцион **может быть открыт**, если:
- инициатор имеет право запуска;
- в системе нет конфликтующего аукциона;
- параметры лота валидны;
- система находится в состоянии `VALID` или `SAFE`.

Аукцион **не может быть открыт**, если:
- активен конфликтующий аукцион;
- система в состоянии `INVALID`;
- нарушены лимиты частоты;
- отсутствует audit-контекст.

---

## 3. Открытие аукциона (Open)

### Инициатор
Аукцион открывается:
- человеком с соответствующими правами;
- через явное действие (не автоматически).

### Обязательные параметры
При открытии фиксируются:
- идентификатор аукциона;
- описание лота;
- правила участия;
- временные границы;
- ограничения (если есть).

### Audit
При открытии **обязательно** фиксируется событие:
- `AuctionOpened`
- с полной мета-информацией.

### Что НЕ происходит
- MC не списываются;
- GMC не начисляются;
- участники не определяются.

---

## 4. Участие в аукционе (Participation)

### Кто может участвовать
Участвовать может пользователь:
- допущенный правилами аукциона;
- находящийся в допустимом состоянии;
- имеющий достаточный MC для ставки.

### Ограничения
- один пользователь может делать несколько ставок;
- ставка всегда является новым событием;
- предыдущие ставки не отменяются.

### Невалидные попытки
Если попытка участия невалидна:
- состояние аукциона не меняется;
- MC не списываются;
- ошибка фиксируется как техническая.

---

## 5. Механика ставок

### Тип ставки
Ставка выражается в MC.

### Минимум и максимум
- минимальная ставка определяется правилами аукциона;
- максимальная ставка может отсутствовать.

### Повторные ставки
- разрешены;
- считаются независимыми событиями;
- не заменяют предыдущие.

### Отмена
Ставка:
- **не может быть отменена**;
- не может быть отозвана задним числом.

---

## 6. Завершение аукциона (Close)

### Условия завершения
Аукцион закрывается:
- по истечении времени;
- вручную, если это предусмотрено правилами.

### Определение победителя
Победителем признаётся:
- участник с наивысшей валидной ставкой;
- зафиксированной до момента закрытия.

### Если ставок нет
- аукцион закрывается без победителя;
- GMC не распределяются;
- событие фиксируется.

---

## 7. Последствия завершения

### Для победителя
- соответствующее количество MC считается использованным;
- GMC признаётся согласно правилам лота;
- все действия фиксируются в audit.

### Для остальных
- их MC не списываются;
- их ставки остаются в audit как факт участия.

### Что НЕ происходит автоматически
- нет перерасчётов;
- нет компенсаций;
- нет повторных запусков.

---

## 8. Связь с GMC

Аукцион:
- **не создаёт GMC автоматически**;
- является условием для признания GMC.

GMC признаётся:
- только после закрытия аукциона;
- только при выполнении всех условий;
- только через зафиксированное событие.

---

## 9. Ошибки и edge-cases

### Параллельные аукционы
- запрещены, если конфликтуют по домену;
- разрешены, если явно разведены правилами.

### Прерывание аукциона
- возможно только вручную;
- требует audit-фиксации причины.

### Повторное открытие
- не является продолжением предыдущего;
- всегда считается новым аукционом.

---

## 10. Запреты и ограничения

Запрещено:
- автоматическое открытие аукционов;
- автоматическое признание GMC;
- вмешательство в историю ставок;
- ручное изменение победителя.

---

## 11. Примеры сценариев

### Нормальный сценарий
1. Аукцион открыт
2. Пользователи делают ставки
3. Аукцион закрыт
4. Победитель определён
5. GMC признан

### Аукцион без участников
1. Аукцион открыт
2. Ставок нет
3. Аукцион закрыт
4. GMC не распределяется

### Ошибочный сценарий
1. Пользователь пытается сделать невалидную ставку
2. Система отклоняет
3. Audit фиксирует ошибку
4. Аукцион продолжается

---

## 12. Краткое резюме

- Аукцион — это событие, а не процесс.
- MC используются для участия, не как деньги.
- GMC признаётся только по результату.
- Ничего не происходит автоматически.
- Вся история неизменяема и аудируема.
